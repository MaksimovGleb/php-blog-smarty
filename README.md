# PHP Blog (Smarty + MySQL)

Простой блог на чистом PHP с использованием шаблонизатора Smarty.

## Технологический стек
- **PHP 8.1+**
- **Smarty 4.3**
- **MySQL**
- **SCSS** (для стилизации)
- **Composer** (для управления зависимостями)

## Архитектура
Проект реализован по принципу разделения ответственности (**MVC**), что обеспечивает чистоту кода и легкость масштабирования.

### Детальная схема проекта
```text
php-blog/
├── assets/                     # Исходные файлы фронтенда
│   └── scss/style.scss         # Стили проекта
├── config/                     # Настройки приложения
│   └── db.php                  # Конфигурация MySQL
├── public/                     # Точка входа (Контроллеры)
│   ├── index.php               # Главная страница: категории + 3 поста
│   ├── category.php            # Страница категории: пагинация + сортировка
│   ├── article.php             # Страница статьи: контент + похожие статьи
│   └── assets/css/style.css    # Скомпилированные стили
├── scripts/                    # Служебные скрипты
│   └── seed.php                # Функционал сидинга
├── src/                        # Логика приложения (Models)
│   ├── Database.php            # Singleton для подключения к PDO
│   ├── bootstrap.php           # Инициализация Smarty и автозагрузки
│   └── Models/                 # Работа с данными
│       ├── BaseModel.php       # Базовый класс с доступом к БД
│       ├── Article.php         # Модель статей (фильтры, просмотры, связи)
│       └── Category.php        # Модель категорий
├── templates/                  # Представления
│   ├── layout.tpl              # Базовый шаблон (общая разметка)
│   ├── index.tpl               # Шаблон главной страницы
│   ├── category.tpl            # Шаблон списка статей категории
│   └── article.tpl             # Шаблон полной статьи
├── database.sql                # SQL-дамп структуры БД
└── composer.json               # Зависимости (Smarty)
```

### Реализация требований ТЗ

#### 1. Структура данных
- Реализована связь **многие-ко-многим** между статьями и категориями через таблицу `article_categories`.
- Статья содержит: изображение, название, описание, текст, количество просмотров и дату публикации.
- Категория содержит: название и описание.

#### 2. Модели (src/Models)
- **Article.php**: содержит методы для получения последних статей, пагинации, сортировки по дате/просмотрам и поиска похожих статей (по пересекающимся категориям).
- **Category.php**: управление категориями, включая получение только тех категорий, в которых есть статьи.

#### 3. Контроллеры (public/)
- **index.php**: реализует логику вывода категорий и 3 последних постов для каждой.
- **category.php**: обрабатывает параметры `sort` (views/date) и `page` для реализации пагинации.
- **article.php**: реализует инкремент счетчика просмотров при каждом посещении и подбор похожих материалов.

#### 4. Сидинг (scripts/seed.php)
- Автоматически наполняет базу данных тестовыми категориями и 20+ статьями с рандомными связями и датами для демонстрации пагинации и сортировки.

## Установка и запуск

### 1. Подготовка зависимостей
```bash
composer install
npm install
```

### 2. Сборка стилей (SCSS)
Вы можете скомпилировать стили вручную:
```bash
npm run css
```

### 2. Настройка базы данных
1. Создайте базу данных `php_blog`.
2. Импортируйте схему из файла `database.sql`.
3. Отредактируйте параметры подключения в `config/db.php`.

### 3. Наполнение данными (Seeding)
Запустите скрипт для генерации тестовых категорий и статей:
```bash
php scripts/seed.php
```

### 4. Запуск сервера
Вы можете использовать встроенный сервер PHP:
```bash
php -S localhost:8000 -t public
```
Сайт будет доступен по адресу `http://localhost:8000`.

## Функционал
- **Главная страница**: вывод категорий и 3 последних постов в каждой.
- **Страница категории**: список всех статей категории с пагинацией и сортировкой (по дате/просмотрам).
- **Страница статьи**: полный текст, счетчик просмотров и блок похожих статей.
